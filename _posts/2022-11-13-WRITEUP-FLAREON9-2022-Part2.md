---
layout: post
title: "[FLAREON9 2022]: Part2"
categories: rev
toc: true
---


## 7 - anode

### Phân tích ban đầu 

- Chạy thử chương trình chỉ hỏi flag và check flag

- Kích thước file khá lớn khiến mình nghĩ có nên load vào IDA không vì có thể rất lâu IDA mới load xong

![image](https://user-images.githubusercontent.com/91442807/202184897-aa92f10e-c0e3-4c8c-b657-17356a80eb86.png)

- Có vẻ là chương trình có **code js** ở bên trong

- Mở file bằng **notepad++** thử:

![image](https://user-images.githubusercontent.com/91442807/202185542-6e288855-64ae-4802-9b00-fe2dcf00e7f4.png)

- Có vẻ phần check flag cũng là phần code js nằm ở cuối file 

- Searh gg mình tìm được một tool là [nexe-decompile](https://www.npmjs.com/package/nexe-decompile) dùng để extract file js ra [xem ở đây](https://github.com/Twi1ight12/CTF/blob/main/flareon9/7-anode/anode.js)

- Đọc code ta thấy đầu tiên nó check độ dài flag phải bằng 44 

-Nhập thử: 

![image](https://user-images.githubusercontent.com/91442807/202187763-2b75a965-fd60-4cfb-ac77-2128f79585c1.png)

- Quan sát ta thấy đối với cái script bị extract thì bị lỗi còn cái file exe thì lại không (có lẽ là yếu tố code c của file exe ảnh hưởnng), suy nghĩ hoài mình ko biết cách pass làm sao nên mình quyết định làm việc trực tiếp trên file exe luôn, bỏ script js qua một bên.

### Phân tích trên file exe 

#### Dump kết quả cuối

- Đầu tiên mình sửa code lại để in ra kết quả cuối cùng:

![image](https://user-images.githubusercontent.com/91442807/202188868-2ae75584-a825-4dfe-9f18-2f19a6dea994.png)

- Lưu ý: ***vừa thêm và xóa code phải đảm bảo sao cho số bytes xóa và số bytes thêm bằng nhau để đảm bảo kích thước cho file khi chạy không bị crash***

- Các trường hợp **switch-case** có các số random nên mình đoán khi chạy cùng input ở các thời điểm khác nhau sẽ cho ra kết quả khác nhau nhưng lại không như vậy:

![image](https://user-images.githubusercontent.com/91442807/202190505-b3e7c094-a3b1-43a0-bab7-f79240c08296.png)


#### Dump giá trị state

- Ta cần giá trị state để biết thứ tự các **case** trong suốt quá trình chạy đến kết quả cuối

![image](https://user-images.githubusercontent.com/91442807/202196902-eb987a7e-5534-4e49-b9ef-8d959ae21fe5.png)

- [anode_pat1.exe]()

![image](https://user-images.githubusercontent.com/91442807/202197238-67fb8466-d5cd-47ad-9288-4b63113b0900.png)


#### Dump giá trị random

- Ta cần biết giá trị random ở một số case:

![image](https://user-images.githubusercontent.com/91442807/202198163-42bbc9e3-ca37-4ee9-93a9-90c10e27d222.png)

- Tiếp tục patch để in ra bởi vì chúng ta biết nó không hề random, như vầy:

![image](https://user-images.githubusercontent.com/91442807/202198531-fec2a19d-cf94-45a6-9649-4d898c8aae07.png)

--> Có quá nhiều trường hợp có số random nên ta không thể patch bằng tay hết và còn phải lo về kích thước bytes nữa -> script:

```python
f=open("anode_pat1.exe", 'rb').readlines()
f1=open("anode_pat1.exe", 'rb').read()
out=b""
patch=open("anode_pat2.exe", 'wb')

for li in f:
    
    if b'Math.floor(Math.random() * 256)' in li:
        add=b'console.log("-->"+Math.floor(Math.random() * 256));\n'
        add=add.rjust(len(li),b' ')
        f1=f1.replace(li, add)
    
patch.write(f1)
```

![image](https://user-images.githubusercontent.com/91442807/202199625-7968dc65-4b8c-4e44-b0e1-5c6da6f89377.png)

#### Dump if/else

- Các case còn có 2 trường hợp if/else nên ta cần phải dump ra xem mỗi case nó theo nhánh nào

![image](https://user-images.githubusercontent.com/91442807/202201268-5c337556-be46-48c8-8620-09ce9dab69f9.png)

- Thêm như vầy nếu mỗi case theo trường hợp **if** thì in ra **c1** còn không in ra gì thì theo trường hợp **else**

-Tương tự như trên rất khó để làm bằng tay

```python
f=open("anode_pat1.exe", "rb").readlines()
f1=open("anode_pat1.exe", "rb").read()

case=open("case.exe", 'wb')

import re

for li in range(len(f)):
    if (re.findall(r"""case \d{3,}:\n""".encode(),f[li]) != []):
        if b'case 185078700' in f[li]:
            continue
        assert b"if" in f[li+1]
        if b'Math.floor(Math.random()' in f[li+2]:
            add=b'console.log("c1,  "+Math.floor(Math.random() * 256));\n'
            add=add.rjust(len(f[li+2]),b' ')

        else:
            add=b'console.log("c1");\n'
            add=add.rjust(len(f[li+2]),b' ')
        
        f1=f1.replace(f[li+2], add)
case.write(f1)
```
![image](https://user-images.githubusercontent.com/91442807/202202081-0447eb85-8d15-4f54-b691-799113bb8069.png)


#### Kết hợp

- Đến đây ta đã có hết dữ liệu ta cần, bây giờ chỉ việc build lại luồng thôi

- Code build dựa trên điều kiện của mỗi trường hợp:

```python
f=open("anode.js", "rb").readlines()

order={1010356043: 'c2', 497278214: 'c2', 181384715: 'c1', 957436102: ['c2', 245], 605458814: 'c2', 
429116243: 'c2', 304625349: 'c2', 580191415: 'c1', 68328143: 'c2', 542039106: 'c2', 549494432: 'c2', 1035147988: 'c1', 493010987: 'c2', 288255168: 'c2', 152320376: 'c2', 644273762: 'c2', 1051637796: ['c2', 56], 220984231: 'c1', 261461743: ['c1', 106], 942994641: 'c2', 935030589: ['c2', 61], 630925076: 'c2', 754053251: 'c1', 504478655: 'c1', 338972092: 'c2', 752876803: 'c2', 657690603: ['c1', 189], 1003847695: 'c2', 578359911: 'c2', 998903508: 'c1', 376132195: 'c2', 
536345467: 'c2', 984396248: 'c1', 436308333: 'c2', 17290114: 'c1', 64944481: 'c2', 364059800: 
'c2', 535029726: ['c2', 7], 861510777: 'c2', 311777325: 'c1', 440786193: 'c2', 843507186: 'c1', 237337400: 'c2', 1066991154: 'c2', 682257123: 'c1', 1013605951: ['c2', 221], 1007745471: ['c2', 198], 662440992: ['c2', 251], 508081179: 'c1', 742853454: 'c2', 506966062: 'c1', 254614724: 'c1', 507505767: 'c2', 1009817857: ['c2', 146], 38681753: 'c1', 326894214: 'c1', 583775143: 
'c2', 137630475: 'c1', 653960194: ['c2', 56], 346377456: 'c1', 111161662: 'c1', 86029451: 'c2', 356968013: 'c1', 998309844: 'c2', 162618506: ['c2', 18], 307715980: 'c2', 843821990: 'c1', 851842599: 'c2', 150806942: 'c1', 171560204: 'c1', 996361116: ['c2', 8], 137590596: ['c2', 140], 965140015: 'c2', 345615088: 'c2', 642986604: ['c2', 153], 746082457: 'c2', 1014985015: 'c2', 460713018: 'c1', 50858850: 'c2', 820331184: 'c2', 754435174: 'c2', 194234029: 'c2', 618469040: 'c2', 346115220: 'c2', 134845953: ['c1', 60], 382922372: ['c1', 28], 738393887: 'c1', 906680424: 'c1', 1027336899: ['c1', 87], 165136772: 'c2', 585872335: ['c2', 42], 410802044: 'c1', 20347334: 'c2', 156265595: 'c2', 425518304: 'c2', 308307937: 'c2', 489644900: 'c2', 721721344: ['c1', 128], 322224592: ['c1', 156], 260248466: ['c2', 174], 557105857: 'c2', 184337331: 'c1', 
509659873: 'c2', 872415933: 'c1', 243572122: 'c2', 781937258: ['c2', 72], 135863760: 'c2', 668502108: 'c2', 901371023: 'c2', 897843229: ['c2', 192], 518976161: 'c2', 581736057: 'c2', 800362995: 'c2', 305375521: 'c2', 246196592: ['c2', 181], 598261111: ['c2', 181], 635490398: 'c1', 
773635926: ['c2', 205], 70871791: 'c1', 703638644: 'c2', 333008690: 'c1', 735283656: 'c1', 1025916139: 'c2', 564468417: 'c2', 705428670: 'c1', 531048198: 'c1', 379529415: 'c2', 721440911: 
'c1', 415110917: 'c2', 540405567: 'c1', 617270605: 'c1', 551829021: 'c2', 211163838: 'c1', 610501194: ['c2', 211], 440354165: 'c2', 898171258: 'c1', 1021595414: 'c2', 93408349: 'c2', 830396152: 'c1', 246675300: 'c2', 418085472: ['c2', 240], 268121630: 'c2', 129895060: 'c2', 393219787: ['c2', 108], 297638766: 'c1', 1010317137: 'c1', 857076787: 'c2', 811423735: 'c2', 786459983: 'c1', 1071767211: 'c1', 839728295: 'c2', 900739574: ['c1', 62], 861075392: 'c1', 932811414: 'c2', 740369788: 'c2', 190154779: 'c2', 530885266: 'c1', 506148129: 'c1', 277284985: 'c1', 169583868: 'c2', 394802322: ['c1', 200], 813512048: ['c2', 98], 915580084: 'c2', 1006187624: 'c1', 201264604: 'c1', 7607673: 'c2', 271627321: 'c2', 849052831: 'c2', 562827068: 'c2', 413708432: ['c1', 145], 805377128: 'c1', 182615591: 'c2', 442381073: 'c2', 770907936: ['c1', 152], 167821939: 'c2', 606417521: ['c2', 224], 694178482: 'c1', 932044333: 'c1', 1027590517: ['c2', 80], 137156820: 'c1', 308137512: 'c2', 242387230: 'c2', 436361812: ['c1', 234], 1007784734: ['c2', 123], 269695589: 'c2', 170255883: ['c2', 132], 831762542: 'c2', 76961033: 'c2', 578413895: 'c2', 296261627: ['c2', 3], 901377278: 'c1', 388219024: 'c1', 314005330: 'c1', 1067849720: 'c2', 427112169: 'c2', 120900299: 'c2', 679907763: ['c2', 213], 847448000: ['c2', 34], 399226168: 
'c2', 194022714: 'c2', 719294338: 'c2', 727581920: 'c2', 867656279: ['c1', 74], 49148585: ['c2', 26], 699096503: 'c1', 262657052: 'c1', 1020638245: ['c2', 125], 748439402: 'c1', 789883991: ['c2', 86], 659612427: 'c2', 892268737: 'c2', 481264118: 'c2', 354670641: 'c2', 39901217: ['c2', 156], 333278516: 'c2', 170953037: ['c1', 5], 439858784: 'c1', 171959181: 'c2', 659273600: 
'c2', 504890843: 'c1', 496002193: 'c2', 366327144: 'c1', 384516053: 'c2', 326512739: 'c1', 1069041735: 'c2', 180361118: 'c2', 818877870: 'c2', 432599280: 'c2', 1034586722: 'c2', 916126752: 'c1', 680818939: ['c2', 117], 1031385455: ['c1', 251], 784248654: ['c2', 212], 633718801: 'c2', 323794006: 'c2', 18752034: ['c1', 183], 897152026: ['c2', 244], 336652146: 'c1', 797682017: 'c1', 211248456: 'c2', 457466717: 'c2', 157380093: 'c2', 168874559: 'c2', 264634585: 'c2', 340943616: 'c2', 806112829: 'c2', 395862207: 'c2', 267460296: ['c2', 181], 747625031: 'c2', 332288104: 'c1', 234522330: ['c2', 135], 943408141: ['c2', 123], 246084964: 'c2', 432794620: 'c1', 814967729: 'c2', 613252913: 'c2', 34833634: 'c2', 176965404: ['c2', 141], 1050297000: 'c1', 590666725: 'c2', 86006683: ['c1', 131], 1032623622: ['c2', 241], 586332565: 'c2', 784551218: 'c2', 436860761: 'c2', 691686948: ['c2', 35], 756608088: 'c2', 468600845: 'c1', 963449270: 'c2', 563644357: 'c1', 230930038: ['c2', 187], 110713232: 'c1', 383403877: ['c1', 155], 881412225: 
'c2', 357341428: 'c1', 1030212277: 'c2', 167118666: ['c1', 241], 1068427493: 'c2', 738234691: 
'c2', 172327403: 'c2', 617252180: 'c1', 287782403: 'c2', 516077630: 'c2', 694925458: 'c2', 647939351: 'c1', 627583527: ['c2', 139], 316759147: 'c2', 343068132: ['c1', 69], 204547457: 'c1', 676900802: 'c1', 900591134: 'c1', 639015755: ['c1', 70], 610287656: ['c2', 156], 933907593: 'c2', 593231004: 'c1', 1045321173: 'c1', 163000418: 'c1', 829813710: 'c2', 922670184: 'c2', 790738357: 'c2', 1033010155: 'c1', 62103505: 'c1', 44075365: 'c2', 648641891: 'c2', 895117942: 'c2', 940887364: ['c2', 177], 768056640: 'c1', 419988815: 'c1', 497039019: ['c1', 120], 311489: 
'c1', 934870917: 'c1', 84809963: ['c1', 210], 391748300: ['c2', 218], 706248766: ['c2', 131], 
576314831: 'c1', 848118829: 'c2', 271112798: 'c2', 852933629: 'c2', 1002376488: 'c2', 891821885: 'c2', 67023845: 'c1', 138090095: ['c2', 225], 388611681: ['c2', 76], 981450373: 'c2', 454175396: 'c2', 515148309: 'c2', 79593073: ['c2', 2], 77910142: 'c2', 565632760: ['c2', 179], 74663331: 'c2', 556468793: 'c2', 510460050: 'c2', 687112427: 'c2', 1017668994: 'c2', 219024877: 'c2', 759656823: ['c2', 185], 631991648: 'c2', 772657164: ['c2', 134], 633013038: 'c2', 858931501: 'c2', 327658034: 'c2', 261889048: 'c2', 463080223: 'c2', 717447985: 'c2', 576084841: 'c1', 
444613685: 'c1', 249647999: 'c2', 400398773: 'c1', 469950833: 'c1', 230923361: 'c2', 757641439: 'c2', 484432842: ['c2', 198], 742863292: ['c1', 19], 543401869: 'c2', 718127991: 'c2', 252277940: 'c2', 209432887: ['c1', 223], 475240679: ['c1', 197], 710626576: 'c2', 527194655: 'c2', 
1001050053: 'c2', 78399834: 'c2', 624024080: 'c1', 476113183: 'c2', 347190308: 'c1', 892829538: 'c2', 72161969: ['c1', 38], 381813752: 'c2', 944233129: 'c2', 495921857: 'c1', 864991412: 'c2', 387100740: 'c2', 975388468: 'c2', 435026594: 'c1', 333413964: ['c2', 75], 376455206: 'c1', 1058172980: 'c2', 481236269: 'c2', 8624110: ['c2', 57], 818621328: 'c2', 435082171: ['c2', 246], 46607160: 'c1', 745685328: 'c2', 635066656: 'c1', 895572296: ['c1', 212], 987159526: 'c1', 15648489: 'c1', 90236103: 'c2', 607021784: 'c2', 638017835: 'c1', 585159232: 'c2', 525162538: 'c2', 75488718: 'c2', 554560760: ['c2', 182], 860441400: 'c2', 651944800: 'c2', 969714121: 'c2', 495847681: 'c1', 610772468: ['c2', 92], 555231932: 'c2', 487732442: 'c2', 746695087: 'c1', 620144002: ['c2', 7], 866514753: 'c2', 188837611: 'c2', 130000735: 'c1', 738349727: ['c2', 175], 275553514: 'c2', 572264589: ['c2', 200], 387974948: 'c2', 288734789: 'c2', 294271724: 'c1', 972033212: 'c2', 703712893: 'c2', 916699096: 'c1', 623102886: 'c2', 659598115: 'c2', 505561575: 'c1', 104812740: ['c2', 28], 604377705: 'c1', 836184180: 'c2', 48246086: 'c2', 1030660026: 'c2', 462197583: 'c1', 572340455: ['c1', 196], 960991331: 'c2', 65487162: 'c1', 288574193: 'c2', 353246766: 'c2', 409252293: 'c1', 390035647: 'c1', 984240743: 'c2', 69352640: 'c2', 987447585: 'c1', 19165082: 'c2', 717701475: 'c2', 798743267: ['c2', 150], 478340892: ['c1', 95], 711458388: 'c1', 824342282: 'c2', 596471964: 'c2', 346310778: 'c1', 960357655: ['c2', 218], 348173505: 'c2', 328293975: ['c2', 127], 959614683: 'c1', 96456627: 'c2', 533103436: 'c1', 719604778: ['c2', 221], 1060070784: 'c2', 1004734575: 'c2', 419650888: 'c2', 703648569: 'c2', 874527885: 'c1', 425993177: 'c2', 107948494: 'c1', 280767414: ['c1', 253], 875167420: 'c2', 580712029: 'c2', 631842634: ['c2', 230], 192326207: 'c2', 98917269: 'c1', 150199466: 'c1', 696914010: 'c2', 1030774184: 'c2', 509219317: 'c2', 54109746: 'c1', 558792733: ['c2', 166], 479895768: ['c1', 20], 887720569: 'c2', 449801452: 'c2', 846465521: 'c2', 485214937: 'c2', 793788927: ['c1', 
200], 913546258: 'c1', 10705897: 'c1', 283679858: 'c2', 981432595: 'c1', 24385348: 'c1', 661359257: 'c2', 220618710: 'c1', 769036486: 'c2', 674866669: 'c2', 293954309: 'c2', 828950227: 'c1', 96633871: 'c2', 105837962: ['c2', 144], 408646337: 'c1', 899494737: 'c1', 652341782: ['c2', 80], 652355755: 'c2', 849670022: 'c1', 811872807: 'c2', 410923009: 'c2', 602845621: 'c2', 934956011: ['c2', 51], 917008021: ['c2', 221], 785338584: 'c2', 469496696: 'c2', 566073241: 'c1', 414443906: ['c1', 200], 355872836: 'c2', 747515263: 'c2', 333723469: 'c2', 244842414: 'c2', 716459371: 'c1', 636356544: ['c1', 21], 224518174: 'c1', 958174320: 'c2', 96720363: 'c2', 275423299: ['c1', 110], 299520450: 'c2', 61896397: 'c1', 113700411: 'c2', 291625724: 'c2', 158215884: 'c1', 640695661: 'c2', 643486477: ['c2', 225], 527973694: 'c2', 103901370: 'c2', 714437222: 'c1', 856589568: 'c2', 823741785: 'c2', 250006002: 'c2', 472968028: 'c1', 876140638: 'c2', 27587950: 'c1', 131273933: 'c2', 805449259: 'c1', 533941089: 'c2', 819632228: 'c2', 929229353: 'c1', 930229865: 'c2', 422010113: ['c2', 148], 591243892: 'c1', 908446718: 'c1', 772702548: 'c2', 333327748: ['c2', 8], 62123647: ['c1', 242], 800562337: 'c1', 669523539: 'c1', 951171326: 'c2', 984960420: 'c2', 355878506: 'c1', 89525183: ['c2', 212], 817291488: 'c2', 889551494: 'c2', 324375396: ['c1', 225], 865663178: 'c2', 971183007: 'c1', 217091233: 'c2', 737600074: 'c2', 
695393418: ['c2', 190], 934739973: ['c1', 57], 724809866: 'c2', 281004428: 'c2', 652875761: ['c2', 7], 572478164: 'c2', 1067938463: ['c2', 239], 458923952: ['c1', 224], 624483777: ['c1', 165], 537347423: 'c2', 965766581: 'c1', 439230522: 'c1', 882184715: 'c1', 100730117: 'c2', 632677318: ['c2', 188], 633234283: 'c2', 554792969: ['c1', 214], 848323846: 'c2', 758478334: 'c2', 225422723: 'c1', 728063058: 'c2', 607680747: 'c1', 541057851: 'c2', 767096117: 'c2', 880735562: 'c2', 13789280: 'c2', 533953311: 'c2', 972593536: 'c1', 1056873066: 'c1', 229494579: 'c2', 
151729253: 'c1', 125689889: 'c2', 292965864: ['c2', 145], 695348820: 'c1', 465610305: 'c1', 629242776: 'c2', 909404652: 'c1', 173142711: 'c2', 638200464: 'c2', 811858629: 'c1', 1031764577: 'c2', 365857434: 'c1', 85080588: ['c2', 3], 129226256: ['c2', 146], 838818428: 'c2', 982330101: 'c2', 607284248: 'c2', 999324458: ['c2', 160], 528361686: ['c2', 10], 422356995: 'c1', 610067499: ['c1', 19], 692337316: 'c2', 105766033: 'c2', 931486041: 'c2', 150911405: 'c1', 982360340: 'c2', 174428270: ['c2', 77], 100941470: 'c2', 430915810: 'c1', 100980325: 'c2', 797748313: 'c1', 835741624: 'c1', 407028537: 'c2', 275097633: 'c2', 287357895: ['c2', 110], 246665663: ['c2', 254], 818884951: 'c2', 897254511: 'c2', 860011824: 'c2', 716894268: 'c1', 345757846: 'c1', 110286030: 'c2', 613821870: 'c1', 700493929: 'c2', 848669108: 'c1', 95593244: 'c2', 221619054: 'c2', 618349901: ['c1', 7], 28925148: ['c2', 17], 344569583: 'c1', 577785340: 'c2', 668741963: 'c2', 412918289: 'c2', 170938055: 'c2', 34947844: 'c2', 22221850: 'c2', 129013201: 'c1', 
907717109: ['c2', 32], 933425415: 'c1', 4634906: 'c1', 940416943: 'c2', 438031715: 'c2', 73566854: ['c2', 228], 1059150294: 'c2', 485391444: 'c2', 184001838: 'c2', 625706758: 'c2', 505192518: 'c2', 470915230: ['c2', 122], 46928954: 'c1', 780429714: 'c2', 495535675: 'c1', 231432592: 'c2', 420148501: 'c2', 755154: 'c1', 95732224: ['c2', 210], 916517681: 'c2', 971907876: 'c2', 662940026: 'c2', 274221760: 'c1', 938822551: 'c2', 151969372: 'c2', 780480466: 'c2', 522741887: 'c2', 860260968: 'c2', 285069999: 'c2', 377916788: 'c2', 861726887: 'c2', 823596773: 'c1', 
903508757: ['c2', 254], 124331859: ['c2', 159], 962077432: 'c2', 953701085: 'c2', 644692480: 'c1', 639995512: 'c2', 117244801: 'c2', 242494677: 'c1', 1009568819: 'c2', 100256691: 'c2', 326353561: 'c2', 975988778: 'c2', 275378278: 'c2', 641228928: ['c2', 154], 1006204370: ['c2', 5], 449523591: 'c2', 1066734042: ['c2', 160], 410332197: 'c1', 703070146: 'c2', 582215318: 'c2', 
574228050: 'c2', 566575688: 'c2', 426062705: 'c1', 310172561: 'c1', 118934062: 'c2', 394460282: 'c2', 793300376: ['c2', 197], 512178077: ['c2', 142], 898191023: 'c1', 421002955: ['c2', 205], 588207953: 'c2', 968134268: 'c1', 221781532: 'c2', 467053882: 'c1', 444826173: 'c2', 648694757: 'c1', 690810179: 'c2', 463157616: 'c1', 45845929: 'c2', 472997066: ['c2', 177], 644893890: 'c1', 433190983: 'c2', 8385273: 'c2', 627838396: 'c2', 671130340: 'c2', 915985451: 'c1', 351641283: 'c2', 943451716: 'c2', 925520064: ['c2', 176], 660852152: 'c1', 102772698: 'c2', 158440818: 'c1', 1056913712: 'c2', 475745844: 'c2', 107012627: 'c2', 124690486: 'c2', 1045388446: 'c1', 110430724: 'c2', 641186517: ['c2', 240], 619249680: 'c1', 708088836: 'c1', 673415921: 'c2', 619255339: ['c2', 170], 787067102: ['c1', 120], 504039263: ['c1', 112], 764848634: 'c1', 797141609: 'c2', 718295275: 'c2', 832291230: ['c1', 187], 59933137: 'c2', 67652373: 'c2', 615167515: 'c2', 658314850: 'c2', 914596104: 'c1', 111025682: 'c2', 553402117: 'c1', 594440623: 'c1', 570515134: 'c2', 613597816: ['c2', 89], 834936404: 'c2', 1023914457: ['c2', 149], 167389661: 'c2', 961924244: 'c2', 967654317: 'c2', 533553662: 'c2', 42721917: 'c2', 124291036: 'c2', 308969481: ['c1', 89], 316553773: 'c1', 279165449: 'c2', 184565984: ['c2', 50], 752415474: 'c2', 
946927507: 'c2', 477914619: 'c2', 578961221: 'c2', 996305121: ['c2', 116], 522895656: 'c2', 950500871: 'c2', 1069471290: ['c1', 106], 824267648: ['c1', 113], 1035069239: 'c2', 76812692: 'c2', 564903350: 'c2', 30908364: 'c2', 478053888: 'c2', 832320: 'c2', 114492214: ['c2', 246], 827518754: 'c1', 560046327: ['c2', 89], 81117788: 'c2', 923850245: 'c1', 589379043: ['c1', 1], 3396517: ['c2', 30], 294180573: 'c2', 968337128: 'c2', 881121355: 'c2', 1032872541: 'c2', 414456846: ['c1', 20], 194691887: ['c2', 238], 779328580: ['c2', 84], 690944261: 'c1', 294918952: ['c2', 243], 431298389: 'c1', 72439384: ['c1', 20], 1037327395: 'c2', 837292277: 'c1', 410002593: 'c2', 862632486: ['c2', 149], 39933208: 'c2', 198364009: 'c2', 107361852: ['c2', 18], 609213482: 'c2', 888027124: 'c2', 667976664: 'c2', 923876614: 'c2', 807171433: 'c2', 266322968: ['c2', 74], 306211: ['c1', 60], 406937840: 'c1', 530940714: 'c2', 74705707: 'c2', 1022867386: 'c2', 979486492: 'c2', 22756596: 'c2', 839201324: ['c1', 159], 561687718: ['c1', 62], 800418041: 
'c2', 588222361: 'c2', 462595729: 'c2', 665367266: ['c1', 243], 208944610: 'c2', 94971741: 'c2', 560687081: 'c2', 899930749: ['c1', 255], 163703821: 'c1', 816828515: 'c2', 492685924: 'c2', 582631280: 'c2', 479865795: 'c2', 487366741: 'c2', 986654093: 'c2', 103663748: 'c2', 717893810: 'c2', 454239079: 'c2', 451948137: 'c1', 779958856: 'c2', 726887314: ['c2', 175], 947199551: 'c1', 728604419: 'c1', 310481047: 'c2', 230205454: 'c2', 238161391: ['c1', 15], 90412683: 'c2', 184226734: 'c1', 526095888: 'c1', 529667627: 'c1', 547061522: 'c2', 105007401: 'c2', 77583880: 'c2', 784888727: 'c2', 160364872: 'c2', 49324191: 'c1', 537237003: ['c2', 108], 451400056: 'c1', 663555074: 'c1', 8969443: 'c1', 1020799775: ['c2', 127], 700644156: 'c2', 62120866: 'c2', 555609705: 'c2', 992775814: 'c2', 1036669856: 'c1', 831977705: 'c2', 455195714: ['c1', 250], 1054182512: 'c1', 82799741: ['c2', 58], 177706338: 'c2', 302795555: 'c2', 310398609: 'c1', 805877939: 'c2', 506773855: 'c1', 927672194: 'c1', 694236448: 'c1', 345294165: 'c2', 397157371: 'c2', 184938092: ['c2', 92], 100604142: 'c2', 376310042: 'c1', 671468345: 'c1', 72654807: ['c2', 234], 148008988: 'c2', 402456529: 'c2', 220609761: 'c2', 750243255: 'c2', 734932685: 'c2', 290491044: 'c2', 810628019: 'c2', 977373188: 'c1', 508258165: 'c1', 109814501: 'c2', 875196562: 'c2', 1043589810: 'c2', 862518440: 'c2', 337619620: ['c2', 122], 961374201: ['c2', 140], 1052448154: 'c2', 155874172: 'c1', 927296609: 'c2', 747124022: 'c2', 980186436: ['c2', 123], 956147074: 'c2', 976014478: 'c2', 529404720: 'c2', 761621198: 'c2', 576642022: ['c1', 6], 392984751: 'c2', 542432804: 'c1', 513668468: 'c2', 164257914: 'c2', 206186554: ['c2', 194], 959452706: 'c2', 377623173: 'c2', 1032070313: 'c2', 412251143: 'c1', 970962237: 'c2', 926634219: 'c2', 
847930810: 'c1', 488117931: ['c2', 48], 154630273: 'c2', 421677992: ['c2', 136], 936214335: 'c1', 300912847: 'c2', 461379671: ['c1', 37], 881440612: 'c2', 657379399: 'c2', 209848935: 'c1', 132987555: 'c2', 282083183: 'c2', 277251462: 'c2', 771105345: 'c2', 337528737: 'c2', 46747763: 'c2', 753140202: 'c2', 149778348: 'c2', 598167998: ['c1', 2], 482034949: 'c2', 1012665353: ['c2', 216], 754246359: 'c2', 1071248168: ['c1', 25], 62823208: 'c1', 574604877: 'c2', 136698433: 'c2', 724665382: 'c1', 812348187: 'c2', 640966734: 'c1', 28799325: ['c2', 123], 1071664271: 'c1', 672968190: 'c2', 568152286: 'c1', 170126216: 'c2', 402768593: 'c2', 586678375: ['c2', 246], 358432243: 'c2', 108953795: 'c1', 650908334: ['c2', 94], 24833479: 'c1', 797360669: ['c2', 90], 107684849: ['c1', 130], 668916821: 'c2', 527739369: ['c2', 117], 644948966: 'c1', 4452539: ['c2', 248], 304382579: 'c1', 980801854: 'c2', 16997611: ['c2', 108], 882237139: 'c1', 338410070: 'c2', 1032477597: 'c1', 715652268: ['c2', 127], 686997760: 'c1', 562103074: ['c2', 127], 167029715: 'c2', 813144274: ['c2', 221], 760544713: 'c2', 152458462: 'c1', 1022290916: 'c1', 177511412: 'c2', 525513317: 'c2', 976505001: 'c1', 664160105: 'c1', 141811531: 'c2', 806248070: 
'c2', 791903896: ['c1', 135], 163327990: ['c1', 172], 1038162449: 'c2', 238416598: 'c2', 1050270889: 'c1', 527233541: 'c2', 34972620: ['c2', 49], 122546316: 'c2', 509314672: ['c2', 131], 741568164: ['c2', 186], 689966138: 'c2', 1055058931: 'c2', 900576857: 'c2', 799331279: 'c2', 983134450: 'c2', 160122652: 'c2', 856154656: 'c2', 1020092396: 'c1', 814323669: 'c2', 340838771: 'c1', 654069315: ['c2', 89], 852370076: 'c2', 413054705: 'c2', 93795926: 'c2', 881848114: 'c2', 27798221: 'c2', 922049847: 'c2', 514347277: ['c2', 154], 517062528: 'c2', 213185957: 'c1', 1071145532: 'c1', 479868974: ['c2', 241], 728750373: 'c1', 704462675: 'c1', 635714957: 'c2', 413338388: 'c2', 425700802: 'c2', 776373276: ['c2', 179], 443632296: 'c1', 1048216731: ['c2', 50], 210975861: 'c2'}

cond=""
for i in order:
    
    for j in range(len(f)):
        if f"case {str(i)}".encode() in f[j]:
            # print(f[j])
            if type(order[i])==str:
                
                if order[i]=="c1":
                    for l in range(2,7):
                        if b'else' in f[j+l]:
                            break
                        cond+=f[j+l].decode()
                        
                elif order[i]=="c2":
                    
                    for l in range(10):
                        if b'else' in f[j+l]:
                            for o in range(1,7):  
                                if b'}' in f[j+l+o]:
                                    break
                                cond+=f[j+l+o].decode()
            
            if type(order[i])==list:
                if order[i][0]=="c1":
                    for l in range(2,7):
                        if b'else' in f[j+l]:
                            break
                        if b'Math.floor(Math.random() * 256)' in f[j+l]:
                            
                            f[j+l]=f[j+l].replace(b"Math.floor(Math.random() * 256)",str(order[i][1]).encode())
                        cond+=f[j+l].decode()
                        
                elif order[i][0]=="c2":
                    
                    for l in range(10):
                        if b'else' in f[j+l]:
                            for o in range(1,7):  
                                if b'}' in f[j+l+o]:
                                    break
                                if b'Math.floor(Math.random() * 256)' in f[j+l+o]:
                                    f[j+l+o]=f[j+l+o].replace(b"Math.floor(Math.random() * 256)",str(order[i][1]).encode())
                                cond+=f[j+l+o].decode()
                
print(cond)
```

- Kết quả: [flow.txt]()

#### Get flag

- Đến đây thì đảo ngược thứ tự flow lại thôi 

- [solve.py]()

![image](https://user-images.githubusercontent.com/91442807/202204647-5ddedd69-31ac-47c1-9a5f-05484a69b79b.png)



