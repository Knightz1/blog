---
layout: post
title: "PLAY ransomware"
categories: malware analysis
toc: true
---

## 1. SAMPLE: [Play ransomware](https://bazaar.abuse.ch/sample/006ae41910887f0811a3ba2868ef9576bbd265216554850112319af878f06e55/)

## 2. Anti static analysis

- Hàm main:

![image](https://user-images.githubusercontent.com/91442807/204834393-586fe8fb-17e7-4990-96db-8595406e63d8.png)

- Có vẻ IDA dịch không rõ lắm, xem lại asm:

![image](https://user-images.githubusercontent.com/91442807/204834819-179eb4a1-1dbc-45f8-80bb-e124cc2819aa.png)

![image](https://user-images.githubusercontent.com/91442807/204834894-0317a55b-496a-48e1-9d96-09d37e94f644.png)

- Có vẻ hàm lấy giá trị trên cùng của stack + 0x35 

- Note:

```
Khi chương trình gọi lệnh call một hàm thì giá trị trên cùng của stack sẽ lưu địa chỉ của instruction tiếp theo.
-> Có nghĩa lấy địa chỉ của `pop edi` là `0xD042F1` + 0x35
```



